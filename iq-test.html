<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ki·ªÉm Tra Ch·ªâ S·ªë IQ - TestYourIQ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .welcome-screen {
            text-align: center;
            animation: fadeIn 0.5s ease-out;
        }

        .welcome-screen h2 {
            color: #333;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .welcome-screen p {
            color: #666;
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .info-box {
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            text-align: left;
        }

        .info-box ul {
            margin-left: 20px;
            color: #666;
        }

        .info-box li {
            margin-bottom: 10px;
        }

        .start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .start-button:active {
            transform: translateY(0);
        }

        .question-screen {
            animation: fadeIn 0.5s ease-out;
        }

        .question-counter {
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-text {
            color: #333;
            font-size: 1.3em;
            margin-bottom: 30px;
            line-height: 1.5;
            font-weight: 500;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f5f5f5;
            border: 2px solid transparent;
            padding: 18px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            color: #333;
            text-align: left;
        }

        .option:hover {
            background: #e8e8ff;
            border-color: #667eea;
        }

        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: flex-end;
        }

        .btn-next, .btn-restart {
            padding: 12px 30px;
            font-size: 1em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-next {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-restart {
            background: #667eea;
            color: white;
        }

        .btn-restart:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .result-screen {
            text-align: center;
            animation: fadeIn 0.5s ease-out;
        }

        .result-screen h2 {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .iq-score {
            display: inline-block;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            font-weight: bold;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .score-interpretation {
            background: #f5f5f5;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: left;
        }

        .score-interpretation h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .score-interpretation p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .detail-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .detail-item h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .detail-item p {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .hidden {
            display: none;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            position: relative;
        }

        .nav-btn:hover:not(.locked) {
            background: #667eea;
            color: white;
        }

        .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .nav-btn.locked {
            opacity: 0.6;
            cursor: not-allowed;
            background: #f0f0f0;
            color: #999;
            border-color: #ccc;
        }

        .nav-btn.locked::after {
            content: "üîí";
            margin-left: 5px;
        }

        .nav-btn.locked:hover {
            background: #f0f0f0;
        }

        .statistics-screen {
            animation: fadeIn 0.5s ease-out;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .stat-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .history-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            border-radius: 8px 8px 0 0;
        }

        .history-table td {
            border-bottom: 1px solid #e0e0e0;
            padding: 15px;
        }

        .history-table tr:hover {
            background: #f5f5f5;
        }

        .improve-screen {
            animation: fadeIn 0.5s ease-out;
        }

        .improve-content {
            margin-top: 20px;
        }

        .tip-card {
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .tip-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .tip-card p {
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            .container {
                padding: 25px;
            }

            .header h1 {
                font-size: 2em;
            }

            .details {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
            }
        }

        /* Payment Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-out;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 100%;
            max-width: 450px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s ease-out;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 8px;
        }

        .modal-header p {
            color: #666;
            font-size: 0.95em;
        }

        .pricing-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .pricing-info .price {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 3px;
        }

        .pricing-info .duration {
            font-size: 1em;
            opacity: 0.9;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #333;
            font-weight: 600;
            font-size: 0.9em;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .benefits {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .benefits h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .benefits ul {
            margin-left: 20px;
        }

        .benefits li {
            margin-bottom: 6px;
            color: #666;
            font-size: 0.9em;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-pay {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-pay:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-pay:active {
            transform: translateY(0);
        }

        .btn-cancel {
            background: #f0f0f0;
            color: #666;
            border: 2px solid #e0e0e0;
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cancel:hover {
            background: #e0e0e0;
        }

        .close-modal {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 1.8em;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #333;
        }

        .modal-content {
            position: relative;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .details {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
                padding: 8px 15px;
                font-size: 0.9em;
            }

            .modal-content {
                max-height: 90vh;
                padding: 25px;
            }

            .form-row {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† TestYourIQ</h1>
            <p>Ki·ªÉm tra ch·ªâ s·ªë IQ c·ªßa b·∫°n</p>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showScreen('welcome')">üè† Trang Ch·ªß</button>
            <button class="nav-btn locked" id="statBtn" onclick="handleLockedFeature(event)">üìä Th·ªëng K√™</button>
            <button class="nav-btn locked" id="improveBtn" onclick="handleLockedFeature(event)">üí° C·∫£i Thi·ªán IQ</button>
        </div>

        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>

        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="welcome-screen">
            <h2>Ch√†o m·ª´ng!</h2>
            <p>H√£y chu·∫©n b·ªã cho b√†i ki·ªÉm tra IQ c·ªßa b·∫°n</p>
            <div class="info-box">
                <ul>
                    <li>‚è±Ô∏è B√†i ki·ªÉm tra g·ªìm 20 c√¢u h·ªèi</li>
                    <li>üí° M·ªói c√¢u h·ªèi ki·ªÉm tra m·ªôt kh√≠a c·∫°nh c·ªßa tr√≠ th√¥ng minh</li>
                    <li>üìä K·∫øt qu·∫£ s·∫Ω ƒë∆∞·ª£c t√≠nh to√°n d·ª±a tr√™n s·ªë c√¢u tr·∫£ l·ªùi ƒë√∫ng</li>
                    <li>‚úÖ Ch·ªçn ƒë√°p √°n t·ªët nh·∫•t cho m·ªói c√¢u h·ªèi</li>
                </ul>
            </div>
            <button class="start-button" onclick="startTest()">B·∫Øt ƒê·∫ßu Ki·ªÉm Tra</button>
        </div>

        <!-- Question Screen -->
        <div id="questionScreen" class="question-screen hidden">
            <div class="question-counter">C√¢u <span id="currentQuestion">1</span>/20</div>
            <div class="question-text" id="questionText"></div>
            <div class="options" id="optionsContainer"></div>
            <div class="button-group">
                <button class="btn-next" id="nextBtn" onclick="nextQuestion()" disabled>C√¢u Ti·∫øp Theo ‚Üí</button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="resultScreen" class="result-screen hidden">
            <h2>K·∫øt Qu·∫£ Ki·ªÉm Tra</h2>
            <div class="iq-score" id="iqScore"></div>
            
            <div class="score-interpretation" id="scoreInterpretation"></div>

            <div class="details">
                <div class="detail-item">
                    <h4>C√¢u Tr·∫£ L·ªùi ƒê√∫ng</h4>
                    <p><span id="correctCount">0</span>/20</p>
                </div>
                <div class="detail-item">
                    <h4>T·ª∑ L·ªá Ch√≠nh X√°c</h4>
                    <p id="accuracy">0%</p>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <button class="btn-restart" onclick="saveResultAndRestart()">üîÑ L√†m L·∫°i B√†i Ki·ªÉm Tra</button>
            </div>
        </div>

        <!-- Statistics Screen -->
        <div id="statisticsScreen" class="statistics-screen hidden">
            <h2>üìä Th·ªëng K√™ C·ªßa B·∫°n</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>T·ªïng S·ªë L·∫ßn L√†m Test</h3>
                    <div class="number" id="totalTests">0</div>
                </div>
                <div class="stat-card">
                    <h3>ƒêi·ªÉm IQ Cao Nh·∫•t</h3>
                    <div class="number" id="highestIQ">-</div>
                </div>
                <div class="stat-card">
                    <h3>ƒêi·ªÉm IQ Trung B√¨nh</h3>
                    <div class="number" id="averageIQ">-</div>
                </div>
                <div class="stat-card">
                    <h3>T·ª∑ L·ªá Ch√≠nh X√°c TB</h3>
                    <div class="number" id="avgAccuracy">-</div>
                </div>
            </div>

            <h3 style="margin-top: 30px; color: #667eea;">üìú L·ªãch S·ª≠ L√†m Test</h3>
            <table class="history-table" id="historyTable">
                <thead>
                    <tr>
                        <th>L·∫ßn Th·ª©</th>
                        <th>ƒêi·ªÉm IQ</th>
                        <th>C√¢u ƒê√∫ng</th>
                        <th>T·ª∑ L·ªá</th>
                        <th>Ng√†y Gi·ªù</th>
                    </tr>
                </thead>
                <tbody id="historyBody">
                    <tr>
                        <td colspan="5" style="text-align: center; color: #999;">Ch∆∞a c√≥ d·ªØ li·ªáu</td>
                    </tr>
                </tbody>
            </table>

            <div style="margin-top: 20px;">
                <button class="btn-restart" onclick="clearHistory()">üóëÔ∏è X√≥a L·ªãch S·ª≠</button>
            </div>
        </div>

        <!-- Improve IQ Screen -->
        <div id="improveScreen" class="improve-screen hidden">
            <h2>üí° C√°ch C·∫£i Thi·ªán Ch·ªâ S·ªë IQ</h2>
            <div class="improve-content">
                <div class="tip-card">
                    <h3>1Ô∏è‚É£ Luy·ªán T·∫≠p Th∆∞·ªùng Xuy√™n</h3>
                    <p>Gi·∫£i c√°c b√†i to√°n, c√¢u ƒë·ªë logic h√†ng ng√†y. C√†ng luy·ªán t·∫≠p nhi·ªÅu, b·ªô n√£o c·ªßa b·∫°n s·∫Ω c√†ng th√≠ch ·ª©ng t·ªët v·ªõi c√°c b√†i to√°n kh√≥.</p>
                </div>

                <div class="tip-card">
                    <h3>2Ô∏è‚É£ ƒê·ªçc S√°ch & H·ªçc T·∫≠p</h3>
                    <p>ƒê·ªçc c√°c cu·ªën s√°ch v·ªÅ logic, to√°n h·ªçc, khoa h·ªçc. H·ªçc c√°c ng√¥n ng·ªØ m·ªõi. M·ªü r·ªông ki·∫øn th·ª©c gi√∫p ph√°t tri·ªÉn tr√≠ th√¥ng minh.</p>
                </div>

                <div class="tip-card">
                    <h3>3Ô∏è‚É£ Ng·ªß ƒê·ªß Gi·∫•c</h3>
                    <p>B·ªô n√£o c·∫ßn 7-8 gi·ªù ng·ªß m·ªói ƒë√™m ƒë·ªÉ ph·ª•c h·ªìi v√† x·ª≠ l√Ω th√¥ng tin. Ng·ªß kh√¥ng ƒë·ªß l√†m gi·∫£m kh·∫£ nƒÉng t∆∞ duy logic.</p>
                </div>

                <div class="tip-card">
                    <h3>4Ô∏è‚É£ T·∫≠p Th·ªÉ D·ª•c Th∆∞·ªùng Xuy√™n</h3>
                    <p>Ho·∫°t ƒë·ªông th·ªÉ ch·∫•t tƒÉng l∆∞u l∆∞·ª£ng m√°u l√™n n√£o, c·∫£i thi·ªán s·ª± t·∫≠p trung v√† tr√≠ nh·ªõ. T·∫≠p th·ªÉ d·ª•c 30 ph√∫t m·ªói ng√†y l√† r·∫•t t·ªët.</p>
                </div>

                <div class="tip-card">
                    <h3>5Ô∏è‚É£ ƒÇn U·ªëng L√†nh M·∫°nh</h3>
                    <p>C√°, tr·ª©ng, h·∫°t, chocolate ƒëen ch·ª©a nhi·ªÅu ch·∫•t dinh d∆∞·ª°ng t·ªët cho n√£o. Tr√°nh th·ª±c ph·∫©m ch·ª©a nhi·ªÅu ƒë∆∞·ªùng v√† ch·∫•t b√©o.</p>
                </div>

                <div class="tip-card">
                    <h3>6Ô∏è‚É£ Gi·∫£i C√¢u ƒê·ªë & Tr√≤ Ch∆°i Tr√≠ Tu·ªá</h3>
                    <p>Ch∆°i c√°c tr√≤ ch∆°i nh∆∞ c·ªù vua, Sudoku, c√°c c√¢u ƒë·ªë logic gi√∫p k√≠ch th√≠ch n√£o b·ªô v√† ph√°t tri·ªÉn t∆∞ duy chi·∫øn l∆∞·ª£c.</p>
                </div>

                <div class="tip-card">
                    <h3>7Ô∏è‚É£ H·ªçc K·ªπ NƒÉng M·ªõi</h3>
                    <p>H·ªçc m·ªôt k·ªπ nƒÉng ho√†n to√†n m·ªõi nh∆∞ nh·∫°c, l·∫≠p tr√¨nh, hay th·ªÉ thao. ƒêi·ªÅu n√†y k√≠ch th√≠ch n√£o t·∫°o c√°c ƒë∆∞·ªùng n·ªëi th·∫ßn kinh m·ªõi.</p>
                </div>

                <div class="tip-card">
                    <h3>8Ô∏è‚É£ H·∫°n Ch·∫ø CƒÉng Th·∫≥ng</h3>
                    <p>CƒÉng th·∫≥ng cao g√¢y h·∫°i cho n√£o. T·∫≠p thi·ªÅn, yoga, hay c√°c ho·∫°t ƒë·ªông th∆∞ gi√£n ƒë·ªÉ gi·∫£m stress.</p>
                </div>

                <div class="tip-card">
                    <h3>9Ô∏è‚É£ Giao Ti·∫øp & Th·∫£o Lu·∫≠n</h3>
                    <p>N√≥i chuy·ªán v·ªõi nh·ªØng ng∆∞·ªùi th√¥ng minh, th·∫£o lu·∫≠n c√°c v·∫•n ƒë·ªÅ ph·ª©c t·∫°p. ƒêi·ªÅu n√†y gi√∫p c·∫£i thi·ªán kh·∫£ nƒÉng t∆∞ duy logic.</p>
                </div>

                <div class="tip-card">
                    <h3>üîü Gi·ªØ T√¢m Tr√≠ T√≤ M√≤</h3>
                    <p>Lu√¥n ƒë·∫∑t c√¢u h·ªèi, t√¨m hi·ªÉu nh·ªØng ƒëi·ªÅu m·ªõi. S·ª± t√≤ m√≤ v√† ham h·ªçc h·ªèi l√† ch√¨a kh√≥a ƒë·ªÉ ph√°t tri·ªÉn tr√≠ th√¥ng minh.</p>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <button class="btn-restart" onclick="showScreen('welcome')">‚Üê Quay L·∫°i Trang Ch·ªß</button>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closePaymentModal()">&times;</span>
            <div class="modal-header">
                <h2>üîì M·ªü Kh√≥a T√≠nh NƒÉng</h2>
                <p>Truy c·∫≠p th·ªëng k√™ v√† l·ªùi khuy√™n c·∫£i thi·ªán IQ</p>
            </div>

            <div class="pricing-info">
                <div class="price">29.000 ƒë</div>
                <div class="duration">Truy c·∫≠p vƒ©nh vi·ªÖn</div>
            </div>

            <div class="benefits">
                <h4>‚ú® B·∫°n s·∫Ω c√≥ ƒë∆∞·ª£c:</h4>
                <ul>
                    <li>üìä Xem th·ªëng k√™ chi ti·∫øt c·ªßa t·∫•t c·∫£ b√†i test</li>
                    <li>üìà Theo d√µi ti·∫øn ƒë·ªô c·∫£i thi·ªán IQ theo th·ªùi gian</li>
                    <li>üí° 10 l·ªùi khuy√™n chuy√™n s√¢u c√°ch c·∫£i thi·ªán IQ</li>
                    <li>üéØ Ph√¢n t√≠ch chi ti·∫øt ƒëi·ªÉm m·∫°nh v√† y·∫øu</li>
                    <li>üìú L·ªãch s·ª≠ l√†m test ƒë·∫ßy ƒë·ªß</li>
                </ul>
            </div>

            <form id="paymentForm">
                <div class="form-group">
                    <label for="fullName">H·ªç v√† T√™n</label>
                    <input type="text" id="fullName" placeholder="Nguy·ªÖn VƒÉn A" required>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="you@example.com" required>
                </div>

                <div class="form-group">
                    <label for="phone">S·ªë ƒêi·ªán Tho·∫°i</label>
                    <input type="tel" id="phone" placeholder="0912345678" required>
                </div>

                <div class="form-group">
                    <label for="cardNumber">S·ªë Th·∫ª</label>
                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="expiryDate">H·∫°n S·ª≠ D·ª•ng</label>
                        <input type="text" id="expiryDate" placeholder="MM/YY" maxlength="5" required>
                    </div>
                    <div class="form-group">
                        <label for="cvv">CVV</label>
                        <input type="text" id="cvv" placeholder="123" maxlength="3" required>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn-pay" onclick="completePayment()">üí≥ Thanh To√°n Ngay</button>
                    <button type="button" class="btn-cancel" onclick="closePaymentModal()">H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const questions = [
            {
                question: "T√¨m s·ªë ti·∫øp theo trong d√£y: 2, 4, 8, 16, ?",
                options: ["24", "32", "30", "20"],
                correct: 1
            },
            {
                question: "N·∫øu t·∫•t c·∫£ m√®o l√† ƒë·ªông v·∫≠t, v√† t·∫•t c·∫£ ƒë·ªông v·∫≠t c·∫ßn th·ª±c ph·∫©m, th√¨ m√®o c·∫ßn th·ª±c ph·∫©m?",
                options: [
                    "ƒê√∫ng",
                    "Sai",
                    "Kh√¥ng ch·∫Øc",
                    "Ph·ª• thu·ªôc"
                ],
                correct: 0
            },
            {
                question: "M·ªôt nh√¢n vi√™n l√†m vi·ªác 5 ng√†y/tu·∫ßn. Anh ·∫•y ki·∫øm ƒë∆∞·ª£c 300.000 ƒë/ng√†y. L∆∞∆°ng 4 tu·∫ßn l√† bao nhi√™u?",
                options: ["6.000.000 ƒë", "5.000.000 ƒë", "7.000.000 ƒë", "8.000.000 ƒë"],
                correct: 0
            },
            {
                question: "3, 6, 12, 24, ?",
                options: ["36", "48", "42", "30"],
                correct: 1
            },
            {
                question: "S√ÅCH : KI·∫æN TH·ª®C = B·∫¢N ƒê·ªí : ?",
                options: ["V·ªä TR√ç", "H∆Ø·ªöNG D·∫™N", "H√åNH ·∫¢NH", "ƒê∆Ø·ªúNG DI"],
                correct: 0
            },
            {
                question: "M·ªôt chi·∫øc h·ªôp ch·ª©a 3 qu·∫£ b√≥ng ƒë·ªè, 2 qu·∫£ b√≥ng xanh, 5 qu·∫£ b√≥ng v√†ng. T·ªïng bao nhi√™u qu·∫£ b√≥ng?",
                options: ["8", "9", "10", "11"],
                correct: 2
            },
            {
                question: "1, 4, 9, 16, 25, ?",
                options: ["35", "36", "37", "40"],
                correct: 1
            },
            {
                question: "N·∫øu A = 2B, B = 2C, v√† C = 4, th√¨ A b·∫±ng bao nhi√™u?",
                options: ["8", "16", "32", "64"],
                correct: 2
            },
            {
                question: "5, 10, 20, 40, ?",
                options: ["60", "70", "80", "90"],
                correct: 2
            },
            {
                question: "L·ª™NG : L√öNG = ? : S√ÅNG",
                options: ["T·ªêT", "B·∫†N", "ƒê√äM", "H√îM"],
                correct: 2
            },
            {
                question: "M·ªôt c√°i b√†n gi√° 500.000 ƒë ƒë∆∞·ª£c gi·∫£m 20%. Gi√° m·ªõi l√† bao nhi√™u?",
                options: ["250.000 ƒë", "100.000 ƒë", "400.000 ƒë", "450.000 ƒë"],
                correct: 2
            },
            {
                question: "2, 3, 5, 7, 11, ?",
                options: ["12", "13", "14", "15"],
                correct: 1
            },
            {
                question: "DOCTOR : B·ªÜNH NH√ÇN = GI√ÅO VI√äN : ?",
                options: ["TR∆Ø·ªúNG H·ªåC", "S√ÅCH V·ªû", "H·ªåC SINH", "B·∫¢N"],
                correct: 2
            },
            {
                question: "Trong m·ªôt l·ªõp 30 h·ªçc sinh, 60% l√† n·ªØ. Bao nhi√™u h·ªçc sinh n·ªØ?",
                options: ["15", "18", "20", "12"],
                correct: 1
            },
            {
                question: "1, 2, 4, 7, 11, ?",
                options: ["15", "16", "17", "18"],
                correct: 2
            },
            {
                question: "SONG : ƒê√îI = TAM : ?",
                options: ["M·ªòT", "BA", "B·ªêN", "NƒÇM"],
                correct: 1
            },
            {
                question: "M·ªôt xe ch·∫°y 120 km trong 2 gi·ªù. V·∫≠n t·ªëc trung b√¨nh l√† bao nhi√™u km/h?",
                options: ["40 km/h", "60 km/h", "80 km/h", "100 km/h"],
                correct: 1
            },
            {
                question: "3, 9, 27, 81, ?",
                options: ["162", "243", "324", "405"],
                correct: 1
            },
            {
                question: "N·∫øu TH·ª® = 4, v√† NƒÇNG = 5, th√¨ L·ª∞C b·∫±ng bao nhi√™u?",
                options: ["2", "3", "4", "5"],
                correct: 1
            },
            {
                question: "10, 9, 8, 7, ?, 5",
                options: ["6", "7", "8", "9"],
                correct: 0
            }
        ];

        let currentQuestionIndex = 0;
        let answers = [];
        let score = 0;
        let testResults = [];
        let isPremium = false;

        // Load premium status and results from localStorage
        function loadData() {
            const savedPremium = localStorage.getItem('isPremium');
            const saved = localStorage.getItem('iqTestResults');
            if (savedPremium) {
                isPremium = JSON.parse(savedPremium);
            }
            if (saved) {
                testResults = JSON.parse(saved);
            }
        }

        // Save premium status to localStorage
        function savePremiumStatus() {
            localStorage.setItem('isPremium', JSON.stringify(isPremium));
        }

        // Save results to localStorage
        function saveResults() {
            localStorage.setItem('iqTestResults', JSON.stringify(testResults));
        }

        function handleLockedFeature(e) {
            if (!isPremium) {
                e.preventDefault();
                openPaymentModal();
            } else {
                const screenName = e.target.textContent.includes('Th·ªëng') ? 'statistics' : 'improve';
                showScreen(screenName);
            }
        }

        function openPaymentModal() {
            document.getElementById('paymentModal').classList.add('show');
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('show');
            document.getElementById('paymentForm').reset();
        }

        function completePayment() {
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const cardNumber = document.getElementById('cardNumber').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const cvv = document.getElementById('cvv').value;

            // Validate form
            if (!fullName || !email || !phone || !cardNumber || !expiryDate || !cvv) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin thanh to√°n!');
                return;
            }

            // Simple validation
            if (cardNumber.replace(/\s/g, '').length !== 16) {
                alert('S·ªë th·∫ª kh√¥ng h·ª£p l·ªá!');
                return;
            }

            if (expiryDate.split('/').length !== 2) {
                alert('H·∫°n s·ª≠ d·ª•ng ph·∫£i c√≥ ƒë·ªãnh d·∫°ng MM/YY!');
                return;
            }

            if (cvv.length !== 3) {
                alert('CVV ph·∫£i c√≥ 3 ch·ªØ s·ªë!');
                return;
            }

            // Simulate payment processing
            alert('‚úÖ Thanh to√°n th√†nh c√¥ng!\n\nC·∫£m ∆°n ' + fullName + ' ƒë√£ mua g√≥i Premium!\n\nB·∫°n ƒë√£ m·ªü kh√≥a t·∫•t c·∫£ t√≠nh nƒÉng.');
            
            // Set premium status
            isPremium = true;
            savePremiumStatus();

            // Close modal and reset form
            closePaymentModal();

            // Update UI
            updateLockedButtons();

            // Show welcome screen
            showScreen('welcome');
        }

        function updateLockedButtons() {
            const statBtn = document.getElementById('statBtn');
            const improveBtn = document.getElementById('improveBtn');

            if (isPremium) {
                statBtn.classList.remove('locked');
                improveBtn.classList.remove('locked');
                statBtn.onclick = () => showScreen('statistics');
                improveBtn.onclick = () => showScreen('improve');
            } else {
                statBtn.classList.add('locked');
                improveBtn.classList.add('locked');
                statBtn.onclick = (e) => handleLockedFeature(e);
                improveBtn.onclick = (e) => handleLockedFeature(e);
            }
        }

        function showScreen(screenName) {
            // Check if user is premium before showing locked screens
            if ((screenName === 'statistics' || screenName === 'improve') && !isPremium) {
                openPaymentModal();
                return;
            }

            // Hide all screens
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('questionScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('statisticsScreen').classList.add('hidden');
            document.getElementById('improveScreen').classList.add('hidden');

            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));

            // Show selected screen
            switch(screenName) {
                case 'welcome':
                    document.getElementById('welcomeScreen').classList.remove('hidden');
                    document.querySelector('.nav-btn').classList.add('active');
                    break;
                case 'statistics':
                    document.getElementById('statisticsScreen').classList.remove('hidden');
                    document.querySelectorAll('.nav-btn')[1].classList.add('active');
                    loadStatistics();
                    break;
                case 'improve':
                    document.getElementById('improveScreen').classList.remove('hidden');
                    document.querySelectorAll('.nav-btn')[2].classList.add('active');
                    break;
            }
        }

        function startTest() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('questionScreen').classList.remove('hidden');
            currentQuestionIndex = 0;
            answers = [];
            score = 0;
            displayQuestion();
        }

        function displayQuestion() {
            const question = questions[currentQuestionIndex];
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option';
                button.textContent = option;
                button.onclick = () => selectOption(index);
                optionsContainer.appendChild(button);
            });

            updateProgressBar();
            document.getElementById('nextBtn').disabled = true;
        }

        function selectOption(index) {
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
            answers[currentQuestionIndex] = index;
            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            if (answers[currentQuestionIndex] === undefined) return;
            
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                displayQuestion();
            } else {
                calculateResult();
            }
        }

        function calculateResult() {
            score = 0;
            for (let i = 0; i < questions.length; i++) {
                if (answers[i] === questions[i].correct) {
                    score++;
                }
            }

            const iqScore = 60 + (score / questions.length) * 80;
            let interpretation = '';

            if (iqScore < 90) {
                interpretation = "<h3>D∆∞·ªõi Trung B√¨nh</h3><p>B·∫°n c·∫ßn c·∫£i thi·ªán k·ªπ nƒÉng gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ v√† t∆∞ duy logic. H√£y th∆∞·ªùng xuy√™n luy·ªán t·∫≠p v·ªõi c√°c b√†i to√°n v√† c√¢u ƒë·ªë.</p>";
            } else if (iqScore < 110) {
                interpretation = "<h3>Trung B√¨nh</h3><p>B·∫°n c√≥ kh·∫£ nƒÉng t∆∞ duy logic b√¨nh th∆∞·ªùng. Ti·∫øp t·ª•c r√®n luy·ªán ƒë·ªÉ c·∫£i thi·ªán k·ªπ nƒÉng c·ªßa m√¨nh.</p>";
            } else if (iqScore < 130) {
                interpretation = "<h3>Cao</h3><p>B·∫°n c√≥ kh·∫£ nƒÉng t∆∞ duy logic t·ªët. B·∫°n c√≥ th·ªÉ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ ph·ª©c t·∫°p m·ªôt c√°ch hi·ªáu qu·∫£.</p>";
            } else {
                interpretation = "<h3>R·∫•t Cao</h3><p>B·∫°n c√≥ kh·∫£ nƒÉng t∆∞ duy logic xu·∫•t s·∫Øc. B·∫°n c√≥ th·ªÉ tr·ªü th√†nh m·ªôt nh√† khoa h·ªçc, k·ªπ s∆∞ ho·∫∑c nh√† to√°n h·ªçc gi·ªèi.</p>";
            }

            document.getElementById('questionScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            document.getElementById('iqScore').textContent = Math.round(iqScore);
            document.getElementById('scoreInterpretation').innerHTML = interpretation;
            document.getElementById('correctCount').textContent = score;
            document.getElementById('accuracy').textContent = Math.round((score / questions.length) * 100) + '%';
        }

        function saveResultAndRestart() {
            const iqScore = 60 + (score / questions.length) * 80;
            const accuracy = Math.round((score / questions.length) * 100);
            
            testResults.push({
                date: new Date().toLocaleString('vi-VN'),
                iqScore: Math.round(iqScore),
                correctAnswers: score,
                accuracy: accuracy
            });
            
            saveResults();
            showScreen('welcome');
        }

        function loadStatistics() {
            if (testResults.length === 0) {
                document.getElementById('totalTests').textContent = '0';
                document.getElementById('highestIQ').textContent = '-';
                document.getElementById('averageIQ').textContent = '-';
                document.getElementById('avgAccuracy').textContent = '-';
                return;
            }

            // Calculate statistics
            const totalTests = testResults.length;
            const highestIQ = Math.max(...testResults.map(r => r.iqScore));
            const averageIQ = Math.round(testResults.reduce((sum, r) => sum + r.iqScore, 0) / totalTests);
            const avgAccuracy = Math.round(testResults.reduce((sum, r) => sum + r.accuracy, 0) / totalTests);

            // Update cards
            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('highestIQ').textContent = highestIQ;
            document.getElementById('averageIQ').textContent = averageIQ;
            document.getElementById('avgAccuracy').textContent = avgAccuracy + '%';

            // Update history table
            const historyBody = document.getElementById('historyBody');
            historyBody.innerHTML = '';
            
            testResults.forEach((result, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><strong>${result.iqScore}</strong></td>
                    <td>${result.correctAnswers}/20</td>
                    <td>${result.accuracy}%</td>
                    <td>${result.date}</td>
                `;
                historyBody.appendChild(row);
            });
        }

        function clearHistory() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô l·ªãch s·ª≠ kh√¥ng?')) {
                testResults = [];
                saveResults();
                loadStatistics();
            }
        }

        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.querySelector('.progress-fill').style.width = progress + '%';
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('paymentModal');
            if (event.target == modal) {
                closePaymentModal();
            }
        }

        // Load data when page loads
        loadData();
        updateLockedButtons();
    </script>
</body>
</html>
